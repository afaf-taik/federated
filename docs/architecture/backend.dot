digraph {
  graph [style="dotted,rounded", size="7.1 100"]
  node [id="grey", shape="box", style="rounded"]
  edge [arrowsize="0.7"]
  newrank=true

  subgraph cluster_low {
    label="Low-Level API"
    core_context [label="Context", id="googleblue"]
  }

  subgraph cluster_high {
    label="High-Level API"
    core_execution_context [label="ExecutionContext", id="googleblue"]
    core_compiler [label="Compiler", id="googleblue"]
    core_runtime [label="Runtime", id="googleblue"]
    core_execution_context -> core_compiler
    core_execution_context -> core_runtime
  }

  core_context -> core_execution_context [style="dashed"]

  subgraph cluster_native {
    label="Native"
    native_context [label="ExecutionContext", href="#context", target="_parent", id="googlegreen"]
    native_compiler [label="Compiler", href="#compiler", target="_parent", id="googlegreen"]
    native_runtime [label="Runtime", href="#runtime", target="_parent", id="googleblue"]
    native_context -> native_compiler
    native_context -> native_runtime
  }

  subgraph cluster_mapreduce {
    label="MapReduce"
    mapreduce_context [label="(Execution)?Context", href="#context-2", target="_parent", id="white", style="dashed,rounded"]
    mapreduce_compiler [label="Compiler", href="#compiler-2", target="_parent", id="googlered"]
    mapreduce_runtime [label="Runtime", href="#runtime-2", target="_parent", id="white", style="dashed,rounded"]
    mapreduce_context -> mapreduce_compiler
    mapreduce_context -> mapreduce_runtime
  }

  subgraph cluster_iree {
    label="IREE"
    iree_context [label="ExecutionContext", href="#context-3", target="_parent", id="googleyellow"]
    iree_compiler [label="Compiler", href="#compiler-3", target="_parent", id="googleyellow"]
    iree_runtime [label="Runtime", href="#runtime-3", target="_parent", id="googleyellow"]
    iree_context -> iree_compiler
    iree_context -> iree_runtime
  }

  subgraph cluster_reference {
    label="Reference"
    reference_context [label="Context", href="#reference", target="_parent", id="purple"]
    reference_compiler [label="Compiler", style="invisible"]
    reference_runtime [label="Runtime", style="invisible"]
    reference_context -> reference_compiler [arrowhead="none", style="invisible"]
    reference_context -> reference_runtime [arrowhead="none", style="invisible"]
  }

  // Layout
  {rank=same; core_context, reference_context}
  {rank=same; core_execution_context, native_context, mapreduce_context, iree_context}
  {rank=same; core_compiler, core_runtime, native_compiler, native_runtime, mapreduce_compiler, mapreduce_runtime, iree_compiler, iree_runtime}
}
